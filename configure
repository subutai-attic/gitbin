#!/bin/sh

showhelp()
{
cat << ENDHELP

usage: configure {options}
Configure git-bin build 
  --static
    Build without dynamic linking to third-party libraries
  --no-tests
    Don't create unit tests
ENDHELP
}

flags="";
debug=1
tests=1
libs="-g -ggdb -lrt -lPocoUtil -lPocoXML -lPocoJSON -lPocoFoundation"

while [ $# -ge 1 ]; do
    case "$1" in
        --static)
            libs="-g -ggdb -Wl,-Bdynamic -lrt -Llib -Wl,-static -lPocoUtil -lPocoXML -lPocoJSON  -lPocoFoundation  -Wl,-Bdynamic -lpthread" ;;
        --help)
            showhelp
            exit 0
            ;;
        *)
            showhelp
            exit 0
            ;;
    esac

    shift
done

echo "# config.make generated by configure script" > config.make
echo "LIBS = $libs" >> config.make

cat <<__EOF__ >> config.make
export LIBS
__EOF__

echo "# config.build generated by configure script" > config.build
cat <<__EOF__ >> config.build
TESTS = $tests
__EOF__
